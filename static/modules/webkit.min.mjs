import pq from"./pq.min.mjs";export default new pq((t,e)=>{let{Array:n,clearInterval:r,clearTimeout:s,crypto:i,document:a,Event:o,FormData:l,frames:c,getComputedStyle:h,HTMLElement:p,Image:d,JSON:g,location:u,navigator:m,Object:f,Proxy:v,String:q,setInterval:w,setTimeout:y,Uint32Array:_,Uint8Array:b,URLSearchParams:x,WebSocket:C,XMLHttpRequest:S}=t,k=(q.fromCodePoint,{refresh(e){u.reload(1<arguments.length?k.set(...arguments):pq.is_string(e)&&k.delete(e))},set(e,t="",r,s,n,i){a.cookie=pq.urlencode(e)+"="+pq.urlencode(t)+(pq.is_int(r)?";expires="+pq.date_create(r).toUTCString():"")+(pq.is_string(s)?";path="+s:"")+(pq.is_string(n)?";domain="+n:"")+(i?";secure":"")},delete(e){a.cookie=pq.urlencode(e)+"=;expires="+pq.date_create(0).toUTCString()},get(e){var e=` ${pq.urlencode(e)}=`,t=` ${a.cookie};`,r=t.indexOf(e)+e.length;return r>=e.length?pq.urldecode(t.substring(r,t.indexOf(";",r))):""},all(){return f.fromEntries(k)},*[Symbol.iterator](){for(var e of a.cookie.split(";")){var t=e.indexOf("=");yield[pq.urldecode(e.substring(0,t).trimLeft()),pq.urldecode(e.substring(t+1))]}}});class E{static id=0;static get(e,t=a){return new E(t.querySelector(e))}static name(e){switch(e.nodeType){case 1:return e.tagName.toLowerCase();case 2:return"@"+e.nodeName;case 7:return"?"+e.nodeName.toLowerCase();default:return e.nodeName}}static create(e,t){e=new E(a.createElement(e));return t&&e.setattr(pq.is_string(t)?{0:t}:t),e}static template(e){var t=a.createElement("template");return t.innerHTML=e,new E(t.content)}constructor(e=a){this.#target=e}#target=null;get target(){return this.#target}get name(){return E.name(this.target)}get id(){return this.target.hasAttribute("id")?this.target.id:this.target.id="wkid"+ ++E.id}get connected(){return this.target.isConnected}get text(){return this.target.textContent}get locked(){return"none"===this.style().pointerEvents}get style(){return this.target.style}style(e=null){return h(this.target,e)}exists(e){this.target&&e(this)}clone(){return new E(this.target.cloneNode(!0))}find(e){return E.get(e,this.target)}setattr(e,t){for(var[r,s]of pq.is_string(e)?[[e,t]]:f.entries(e))"0"===r?this.text(s):pq.is_scalar(s)?this.target.setAttribute(r,s):this.target.setAttributeNode(a.createAttribute(r));return this}text(e){return this.target.textContent=e,this}on(e,t){return this.target.addEventListener(e,t),this}off(e,t){return this.target.removeEventListener(e,t),this}once(e,t){return this.target.addEventListener(e,t,{once:!0}),this}event(e,t,r,s){return this.target.dispatchEvent(new o(e,{bubbles:t,cancelable:r,composed:s}))}fetch(e){}remove(e){if(pq.is_string(e))if("*"===e)for(;this.target.firstChild;)this.target.removeChild(this.target.lastChild);else for(var t of this.target.childNodes)E.name(t)===e&&this.target.removeChild(t);else this.target.remove();return this}append(e,t){return pq.is_string(e)?e=E.create(e,t):t&&e.setattr(t),this.target.appendChild(e.target),e}}class T extends E{#retval;#header=E.create("header");#section=E.create("section");#footer=E.create("footer");#cancel=E.create("button");#accept=E.create("button");constructor(r){let s=!0;super(a.createElement("dialog")),this.#accept.on("click",()=>this.close(null)),this.#cancel.on("click",()=>this.close(e)),this.on("close",async e=>{var t;!1===s&&e.isTrusted&&(this.remove(),await this.resolve(this.#retval),s=!0),s&&!1===this.target.open&&this.length&&(s=!1,[e,t]=n.prototype.shift.call(this),pq.is_function(e)&&(this.remove("*"),await e.apply(this,t)),a.body?a.body.appendChild(this.target)[r?"showModal":"show"]():s=n.prototype.shift.call(this))})}get retval(){return this.#retval}draw(e){return pq.is_scalar(e.class)?this.target.className=e.class:this.target.removeAttribute("class"),pq.is_scalar(e.title)&&this.append(this.#header.text(e.title)),this.append(pq.is_scalar(e.content)?this.#section.text(e.content):this.#section.remove("*")),this.#footer.remove("*"),pq.is_scalar(e.accept)&&this.#footer.append(this.#accept.text(e.accept)),pq.is_scalar(e.cancel)&&this.#footer.append(this.#cancel.text(e.cancel)),this.#footer.target.childElementCount&&this.append(this.#footer),this.#section}open(t,...r){return this.#retval=e,pq.promise(e=>{n.prototype.push.call(this,[t,r],e),this.event("close")})}async resolve(e){return this.length&&this[0].toString().includes("[native code]")?n.prototype.shift.call(this)(e):Promise.resolve(e)}close(e){return this.#retval=e,this.target.close(),this}}class L extends l{toString(){return new x(this).toString()}}class N extends S{accept(e){return this.responseType=e,this}request(e,t,r=null,s=null){return this.open(e,t,!0),s&&this.setRequestHeader("Content-Type",s),pq.promise((e,t)=>{this.onload=e,this.onerror=t,this.send(r)}).then(e=>e.target)}}class A extends C{ping(){super.send(new b([9]))}pong(){super.send(new b([10]))}send(e){super.send(pq.is_object(e)?g.stringify(e):e)}}function I(r){return new v(f.assign((e,...t)=>r[e](...t),{storage:r}),{apply(e,...[,t]){return e(...t)},set(...[,e,t]){return r.setItem(e,t),!0},deleteProperty(...[,e]){return r.removeItem(e),!0},get(...[,e]){return r.getItem(e)},has(...[,e]){return null!==r.getItem(e)}})}return new v(f.assign(f.defineProperties(pq,{xhr:{get(){return new N}}}),{cookie:k,element:E,extend:(e,t)=>f.assign({element:E,dialog:T,formdata:L,websocket:A}[e].prototype,t),copy(e){return m.clipboard.writeText(e)},session:I(t.sessionStorage),storage:I(t.localStorage),is_element:e=>pq.is_a(e,p),is_formdata:e=>"FormData"===pq.gettype(e),is_window:e=>e===t||pq.in_array(e,c,!0),random_bytes:e=>i.getRandomValues(new pq.struct(e)).latin1,random_int:(e,t)=>i.getRandomValues(new _(1))[0]%(t-e)+e,setcookie:(...e)=>!k.set(...e),deferred:f.assign((e,t=0,...r)=>y(e,t,...r),{cancel(e){s(e)}}),interval:f.assign((e,t=0,...r)=>w(e,t,...r),{cancel(e){r(e)}}),reload:(e=!1)=>u.reload(e),loadimage:s=>pq.promise((e,t)=>{var r=new d;r.onload=e,r.onerror=t,r.src=s}).then(e=>new E(e.target)),formdata:e=>new L(e),websocket:(s,n)=>pq.promise((e,t)=>{var r=new A(s,n);r.onopen=e,r.onerror=t}).then(e=>e.target),dialog:e=>new T(e)}),{apply(e,...[,[t]]){return e.is_string(t)?E.get(t):new E(t)}})});